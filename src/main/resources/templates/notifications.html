<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications - Reliable Carriers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'reliable': {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        'reliable-yellow': {
                            50: '#fefce8',
                            100: '#fef9c3',
                            200: '#fef08a',
                            300: '#fde047',
                            400: '#facc15',
                            500: '#eab308',
                            600: '#ca8a04',
                            700: '#a16207',
                            800: '#854d0e',
                            900: '#713f12',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'bounce-gentle': 'bounceGentle 2s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        bounceGentle: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-gradient-to-r from-reliable-800 to-reliable-900 text-white shadow-lg">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <a href="/" class="flex items-center space-x-2 text-2xl font-bold text-white hover:text-reliable-yellow-300 transition-colors duration-300">
                    <i class="fas fa-truck text-reliable-yellow-400"></i>
                    <span>Reliable Carriers</span>
                </a>
                <ul class="hidden md:flex space-x-8">
                    <li><a href="/" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Home</a></li>
                    <li><a href="/tracking" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Track Package</a></li>
                    <li><a href="/about" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">About</a></li>
                    <li><a href="/contact" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Contact</a></li>
                    <li class="guest-only"><a href="/login" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Login</a></li>
                    <li class="guest-only"><a href="/register" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Register</a></li>
                    <li class="auth-required hidden"><a href="/dashboard" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Dashboard</a></li>
                    <li class="auth-required hidden"><a href="/booking" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Book Service</a></li>
                    <li class="auth-required hidden"><a href="#" id="logoutBtn" class="text-white hover:text-reliable-yellow-300 transition-colors duration-300 font-medium">Logout</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="relative bg-gradient-to-r from-reliable-700 to-reliable-800 text-white py-20">
        <div class="absolute inset-0 bg-black opacity-50"></div>
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-6xl font-bold mb-6 animate-fade-in">Notifications</h1>
            <p class="text-xl md:text-2xl mb-8 opacity-90 animate-slide-up">Test and manage email and SMS notifications</p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <!-- Email Notification Form -->
        <section class="mb-16 animate-slide-up">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-envelope mr-2 text-reliable-600"></i>Send Email Notification</h2>
                <form id="emailForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="emailTo" class="block text-sm font-medium text-gray-700 mb-2">To Email *</label>
                            <input type="email" id="emailTo" name="emailTo" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-reliable-500 focus:border-transparent transition-all duration-300"
                                   placeholder="Enter recipient email">
                        </div>
                        <div>
                            <label for="emailSubject" class="block text-sm font-medium text-gray-700 mb-2">Subject *</label>
                            <input type="text" id="emailSubject" name="emailSubject" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-reliable-500 focus:border-transparent transition-all duration-300"
                                   placeholder="Enter email subject">
                        </div>
                    </div>
                    <div>
                        <label for="emailMessage" class="block text-sm font-medium text-gray-700 mb-2">Message *</label>
                        <textarea id="emailMessage" name="emailMessage" rows="5" required 
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-reliable-500 focus:border-transparent transition-all duration-300"
                                  placeholder="Enter email message"></textarea>
                    </div>
                    <button type="submit" 
                            class="bg-reliable-600 hover:bg-reliable-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105">
                        Send Email
                    </button>
                </form>
            </div>
        </section>

        <!-- SMS Notification Form -->
        <section class="mb-16 animate-slide-up">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-sms mr-2 text-reliable-600"></i>Send SMS Notification</h2>
                <form id="smsForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="smsPhone" class="block text-sm font-medium text-gray-700 mb-2">Phone Number *</label>
                            <input type="tel" id="smsPhone" name="smsPhone" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-reliable-500 focus:border-transparent transition-all duration-300"
                                   placeholder="Enter phone number (e.g., +27123456789)">
                        </div>
                        <div>
                            <label for="smsMessage" class="block text-sm font-medium text-gray-700 mb-2">Message *</label>
                            <textarea id="smsMessage" name="smsMessage" rows="3" required 
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-reliable-500 focus:border-transparent transition-all duration-300"
                                      placeholder="Enter SMS message (max 160 characters)"></textarea>
                        </div>
                    </div>
                    <button type="submit" 
                            class="bg-reliable-600 hover:bg-reliable-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105">
                        Send SMS
                    </button>
                </form>
            </div>
        </section>

        <!-- Test Results -->
        <section class="mb-16 animate-slide-up">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-clipboard-list mr-2 text-reliable-600"></i>Test Results</h2>
                <div id="testResults" class="space-y-4">
                    <div class="text-center text-gray-500">
                        <i class="fas fa-info-circle text-2xl mb-2"></i>
                        <p>Test results will appear here after sending notifications</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Test Buttons -->
        <section class="mb-16 animate-slide-up">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-bolt mr-2 text-reliable-600"></i>Quick Tests</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <button onclick="testShipmentStatusUpdate()" 
                            class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-truck mr-2"></i>Shipment Status Update
                    </button>
                    <button onclick="testDeliveryReminder()" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-bell mr-2"></i>Delivery Reminder
                    </button>
                    <button onclick="testDriverAlert()" 
                            class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-exclamation-triangle mr-2"></i>Driver Alert
                    </button>
                    <button onclick="testTrackingManagerAlert()" 
                            class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-user-shield mr-2"></i>Tracking Manager Alert
                    </button>
                    <button onclick="testSystemNotification()" 
                            class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-cog mr-2"></i>System Notification
                    </button>
                    <button onclick="testMovingServiceNotification()" 
                            class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-truck-moving mr-2"></i>Moving Service Notification
                    </button>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="bg-gradient-to-r from-reliable-yellow-500 to-reliable-yellow-600 text-white rounded-2xl p-8 text-center">
            <h2 class="text-3xl font-bold mb-4">Need Help with Notifications?</h2>
            <p class="text-xl mb-6 opacity-90">Our support team is here to help you set up and manage notifications</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="/contact" class="bg-white text-reliable-yellow-600 font-bold py-3 px-8 rounded-lg hover:bg-gray-100 transition-all duration-300 transform hover:scale-105">
                    Contact Support
                </a>
                <a href="/dashboard" class="bg-transparent border-2 border-white text-white font-bold py-3 px-8 rounded-lg hover:bg-white hover:text-reliable-yellow-600 transition-all duration-300 transform hover:scale-105">
                    Go to Dashboard
                </a>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 text-reliable-yellow-400">Reliable Carriers</h3>
                    <p class="text-gray-300">Professional courier services you can trust for all your delivery needs.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Services</h4>
                    <ul class="space-y-2 text-gray-300">
                        <li><a href="#" class="hover:text-reliable-yellow-400 transition-colors">Express Delivery</a></li>
                        <li><a href="#" class="hover:text-reliable-yellow-400 transition-colors">Moving Services</a></li>
                        <li><a href="#" class="hover:text-reliable-yellow-400 transition-colors">Load Transport</a></li>
                        <li><a href="#" class="hover:text-reliable-yellow-400 transition-colors">International Shipping</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Support</h4>
                    <ul class="space-y-2 text-gray-300">
                        <li><a href="/contact" class="hover:text-reliable-yellow-400 transition-colors">Contact Us</a></li>
                        <li><a href="/tracking" class="hover:text-reliable-yellow-400 transition-colors">Track Package</a></li>
                        <li><a href="/price-list" class="hover:text-reliable-yellow-400 transition-colors">Price List</a></li>
                        <li><a href="#" class="hover:text-reliable-yellow-400 transition-colors">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Contact Info</h4>
                    <div class="space-y-2 text-gray-300">
                        <p><i class="fas fa-phone mr-2"></i> +27 11 123 4567</p>
                        <p><i class="fas fa-envelope mr-2"></i> info@reliablecarriers.co.za</p>
                        <p><i class="fas fa-map-marker-alt mr-2"></i> Johannesburg, South Africa</p>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-300">
                <p>&copy; 2024 Reliable Carriers. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script th:src="@{/js/app.js}"></script>
    <script>
        // Email form submission
        document.getElementById('emailForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                to: document.getElementById('emailTo').value,
                subject: document.getElementById('emailSubject').value,
                message: document.getElementById('emailMessage').value
            };
            
            try {
                const response = await fetch('/api/notifications/send-email', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + getAuthToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                addTestResult('Email', result.success ? 'Success' : 'Failed', result.message || 'Email sent successfully');
            } catch (error) {
                addTestResult('Email', 'Failed', 'Error sending email: ' + error.message);
            }
        });

        // SMS form submission
        document.getElementById('smsForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                phoneNumber: document.getElementById('smsPhone').value,
                message: document.getElementById('smsMessage').value
            };
            
            try {
                const response = await fetch('/api/notifications/send-sms', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + getAuthToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                addTestResult('SMS', result.success ? 'Success' : 'Failed', result.message || 'SMS sent successfully');
            } catch (error) {
                addTestResult('SMS', 'Failed', 'Error sending SMS: ' + error.message);
            }
        });

        // Quick test functions
        async function testShipmentStatusUpdate() {
            try {
                const response = await fetch('/api/notifications/test/shipment-status-update', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + getAuthToken()
                    }
                });
                const result = await response.json();
                addTestResult('Shipment Status Update', result.success ? 'Success' : 'Failed', result.message);
            } catch (error) {
                addTestResult('Shipment Status Update', 'Failed', error.message);
            }
        }

        async function testDeliveryReminder() {
            try {
                const response = await fetch('/api/notifications/test/delivery-reminder', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + getAuthToken()
                    }
                });
                const result = await response.json();
                addTestResult('Delivery Reminder', result.success ? 'Success' : 'Failed', result.message);
            } catch (error) {
                addTestResult('Delivery Reminder', 'Failed', error.message);
            }
        }

        async function testDriverAlert() {
            try {
                const response = await fetch('/api/notifications/test/driver-alert', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + getAuthToken()
                    }
                });
                const result = await response.json();
                addTestResult('Driver Alert', result.success ? 'Success' : 'Failed', result.message);
            } catch (error) {
                addTestResult('Driver Alert', 'Failed', error.message);
            }
        }

        async function testTrackingManagerAlert() {
            try {
                const response = await fetch('/api/notifications/test/tracking-manager-alert', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + getAuthToken()
                    }
                });
                const result = await response.json();
                addTestResult('Tracking Manager Alert', result.success ? 'Success' : 'Failed', result.message);
            } catch (error) {
                addTestResult('Tracking Manager Alert', 'Failed', error.message);
            }
        }

        async function testSystemNotification() {
            try {
                const response = await fetch('/api/notifications/test/system-notification', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + getAuthToken()
                    }
                });
                const result = await response.json();
                addTestResult('System Notification', result.success ? 'Success' : 'Failed', result.message);
            } catch (error) {
                addTestResult('System Notification', 'Failed', error.message);
            }
        }

        async function testMovingServiceNotification() {
            try {
                const response = await fetch('/api/notifications/test/moving-service-notification', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + getAuthToken()
                    }
                });
                const result = await response.json();
                addTestResult('Moving Service Notification', result.success ? 'Success' : 'Failed', result.message);
            } catch (error) {
                addTestResult('Moving Service Notification', 'Failed', error.message);
            }
        }

        function addTestResult(type, status, message) {
            const resultsContainer = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `p-4 rounded-lg border ${status === 'Success' ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`;
            resultDiv.innerHTML = `
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-bold ${status === 'Success' ? 'text-green-800' : 'text-red-800'}">${type}</h4>
                        <p class="text-sm ${status === 'Success' ? 'text-green-600' : 'text-red-600'}">${message}</p>
                    </div>
                    <div class="text-right">
                        <span class="inline-block px-2 py-1 text-xs font-semibold rounded ${status === 'Success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">${status}</span>
                        <p class="text-xs text-gray-500 mt-1">${timestamp}</p>
                    </div>
                </div>
            `;
            
            resultsContainer.appendChild(resultDiv);
            resultsContainer.scrollTop = resultsContainer.scrollHeight;
        }

        function getAuthToken() {
            return localStorage.getItem('authToken') || '';
        }
    </script>
</body>
</html>
